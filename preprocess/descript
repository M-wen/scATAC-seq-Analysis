Currently, 10X genomics, Bio-rad, and DNBelab C4 platform are the three main platforms where single-cell ATAC-seq library construction methods are concentrated. Based on their unique database construction characteristics, the three main platforms have developed their own data preprocessing and analysis systems. The following steps can be used to divide the main analysis steps (table 1).
Barcode processing. 
The barcode sequences, the cells' identification, which usually are located at read 1, consist of 16â€“20 bp. Each selected barcode sequence is compared to a list of permitted valid barcode sequences, and one or two mismatch (harming distance) are corrected. The reads with valid barcode sequence can be remained to align to reference genome. Before aligning to the reference, the valid barcode sequence should be trimmed and parsed in the read names in the cellranger ATAC and Bio-rad ATAC-seq analysis toolkit. By the way, the barcode preprocessing would be combined with alignment step in DNBelab C4 ATAC-seq analysis v3 pipeline.
Alignment
The read mapping ratio is a key indicator of the overall quality of scATAC-seq data. Because both scATAC-seq and bulk ATAC-seq technologies sequence chromatin profile into reads to generate raw data in fastq format, there are no differences in read alignment between these two types of ATAC-seq data. Mapping was carried out with both BWA-MEM (ref) and Bowtie2 (ref), the two short read alignment software most frequently used in ATAC-seq. Another software Chromap (ref), designed for chromatin profile sequencing alignment, reduces the computational time and have similar accuracy comparing to BWA-MEM and Bowtie2. Furthermore, process the barcode sequencing, alignment filtering, and deduplication steps can also performance in Chromap.
In single cell ATAC-seq, the barcode processed sequences after trimming the adapter would be mapped to the reference. The software BWA-MEM would be used mapping in in the cellranger ATAC and Bio-rad ATAC-seq analysis. The software chromap is employed in DNBelab C4 ATAC-seq analysis v3 pipeline. 
Cell calling. 
In this step, the cells loaded from the sample associated to a subset of barcodes can be detected using the fragment number of each barcode in the library. 
Based on empirical observation, this method makes the assumption that fragment number varies between cells in a sample by about an order of magnitude. It has a tendency to separate the barcodes that correspond to real cells from the non-cell or lysis barcodes, when the sample is made up of a variety of cell populations with incredibly disparate fragment number. This is evident when the barcode rank plot displays a second distribution (or a knee plot). 
Due to the low frequency of gel bead multiplets in 10X genomics, where a cell shares more than one gel bead, there is little impact on downstream analysis. Cell Ranger ATAC can exam whether a potential gel bead share more genomically Tn5 insertion sites (sharing a transposition event) with one another, and discard the barcode that has the fewest fragments. However, there is more than 20% multiplets in Bio-rad and DNBelab C4 platform, multiple beads occurring within the same droplet would be merged to get real cell. Multiplet were identified by calculate the jaccard index between barcode pairs.
